<% include ./partials/header.ejs %>
<div class="w-full min-h-screen bg-black text-white">
  <!-- Header/Navbar -->
  <div class="sticky top-0 z-10 bg-black bg-opacity-80 backdrop-blur-sm flex justify-between items-center p-4 border-b border-gray-800">
    <h3 class="text-lg font-semibold"><%= userprofile.username %></h3>
    <div class="icons flex gap-5">
      <a href="/upload" class="text-2xl"><i class="ri-add-box-line"></i></a>
      <button class="text-2xl"><i class="ri-menu-line"></i></button>
    </div>
  </div>

  <!-- Profile Section -->
  <div class="p-4">
    <!-- Profile Info Row -->
    <div class="flex items-center gap-4">
      <!-- Profile Picture -->
      <div class="w-24 h-24 rounded-full border-2 border-pink-500 p-0.5">
        <img 
          class="w-full h-full object-cover rounded-full" 
          src="/images/uploads/<%= userprofile.picture || 'default-profile.jpg' %>" 
          alt="Profile"
          onerror="this.src='/images/default-profile.jpg'"
        >
      </div>
      
      <!-- Stats -->
      <div class="flex-1 flex justify-around">
        <div class="flex flex-col items-center">
          <span class="font-bold text-lg"><%= userprofile.posts.length %></span>
          <span class="text-xs text-gray-400">Posts</span>
        </div>
        <div class="flex flex-col items-center">
          <span class="font-bold text-lg"><%= userprofile.followers.length %></span>
          <span class="text-xs text-gray-400">Followers</span>
        </div>
        <div class="flex flex-col items-center">
          <span class="font-bold text-lg"><%= userprofile.following.length %></span>
          <span class="text-xs text-gray-400">Following</span>
        </div>
      </div>
    </div>

    <!-- Bio Section -->
    <div class="mt-4">
      <h2 class="font-semibold"><%= userprofile.name %></h2>
      <p class="text-sm mt-1 text-gray-300">
        <%= userprofile.bio || "No bio yet." %>
      </p>
    </div>

    <!-- Action Buttons -->
    <div class="flex gap-2 mt-4">
      <% if(user.following.includes(userprofile._id)) { %>
        <a href="/follow/<%= userprofile._id %>" class="flex-1 py-1.5 text-center bg-gray-800 hover:bg-gray-700 rounded-md text-sm font-medium">
          Following
        </a>
      <% } else { %>
        <a href="/follow/<%= userprofile._id %>" class="flex-1 py-1.5 text-center bg-blue-500 hover:bg-blue-600 rounded-md text-sm font-medium">
          Follow
        </a>
      <% } %>
      <a href="#" class="flex-1 py-1.5 text-center bg-gray-800 hover:bg-gray-700 rounded-md text-sm font-medium">
        Message
      </a>
      <a href="#" class="flex-1 py-1.5 text-center bg-gray-800 hover:bg-gray-700 rounded-md text-sm font-medium">
        <i class="ri-arrow-down-s-line"></i>
      </a>
    </div>
  </div>

  <!-- Posts Tabs -->
  <div class="flex border-t border-gray-800 mt-4">
    <button class="flex-1 py-3 text-center border-t border-white">
      <i class="ri-grid-fill"></i>
    </button>
    <button class="flex-1 py-3 text-center text-gray-500">
      <i class="ri-film-line"></i>
    </button>
    <button class="flex-1 py-3 text-center text-gray-500">
      <i class="ri-user-3-line"></i>
    </button>
  </div>

  <!-- Posts Grid -->
  <div class="grid grid-cols-3 gap-1">
    <% if(userprofile.posts.length > 0) { %>
      <% userprofile.posts.reverse().forEach(function(post){ %>
        <a href="/post/<%= post._id %>" class="aspect-square relative group">
          <img 
            class="w-full h-full object-cover" 
            src="/images/uploads/<%= post.picture %>" 
            alt="Post"
            onerror="this.src='/images/default-post.jpg'"
          >
          <div class="absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition">
            <div class="text-white flex items-center mr-4">
              <i class="ri-heart-line mr-1"></i>
              <span><%= post.likes.length %></span>
            </div>
            <div class="text-white flex items-center">
              <i class="ri-chat-3-line mr-1"></i>
              <span><%= post.comments.length %></span>
            </div>
          </div>
        </a>
      <% }); %>
    <% } else { %>
      <div class="col-span-3 flex flex-col items-center justify-center py-16">
        <div class="w-16 h-16 border-2 border-white rounded-full flex items-center justify-center mb-4">
          <i class="ri-camera-line text-2xl"></i>
        </div>
        <h3 class="text-xl font-bold">No Posts Yet</h3>
        <% if(userprofile._id.toString() === user._id.toString()) { %>
          <p class="text-gray-400 mt-2">When you share photos and videos, they'll appear here.</p>
          <a href="/upload" class="mt-4 text-blue-400 font-medium">Share your first photo</a>
        <% } else { %>
          <p class="text-gray-400 mt-2">When <%= userprofile.username %> shares photos and videos, they'll appear here.</p>
        <% } %>
      </div>
    <% } %>
  </div>
</div>
<% include ./partials/footer.ejs %>